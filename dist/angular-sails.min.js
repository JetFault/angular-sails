!function(t,n){"use strict";t.module("ngSails",["ng"]),t.module("ngSails").provider("$sails",function(){var o=this,e=["get","post","put","delete"],s=["on","once"],i=[],r=[];this.socketHostPort=void 0,this.socketOptions=void 0,this.responseHandler=void 0,this.addRequestTransform=function(t){i.push(t)},this.addResponseTransform=function(t){r.push(t)},this.$get=["$q","$timeout","$injector",function(i,r,a){var u=n.connect(o.socketHostPort,o.socketOptions),c=this.responseHandler?a.invoke(this.responseHandler):function(n,o,e){var s={data:o,jwr:e};e&&t.isObject(e)&&e.statusCode&&!isNaN(e.statusCode)&&2!==Math.floor(e.statusCode/100)?n.reject(s):n.resolve(s)},f=function(t,n){r(function(){t(n)})},h=function(n){u["legacy_"+n]=u[n],u[n]=function(e,s,r){-1!==["put","post","patch","delete"].indexOf(n)&&(s=s||{});var a={data:s,method:n,url:e,headers:r},f=function(t){var n=i.defer();return u["legacy_"+t.method](t.url,t.data,function(t,o){c(n,t,o)}),n.promise},h=[f],d=i.when(a);for(t.forEach(o.transformRequest,function(t){h.unshift(t)}),t.forEach(o.transformResponse,function(t){h.push(t)});h.length;)d=d.then(h.shift());return d}},d=function(n){u["legacy_"+n]=u[n],u[n]=function(o,e){null!==e&&t.isFunction(e)&&u["legacy_"+n](o,function(t){f(e,t)})}};return t.forEach(o.transformRequest,function(t){t=a.invoke(t)}),t.forEach(o.transformResponse,function(t){t=a.invoke(t)}),t.forEach(e,h),t.forEach(s,d),u}]})}(angular,io);